group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")
table(correct_data$subject, correct_data$group)
correct_data <-  dataset_gw1%>%filter(Pt.code != "3gtxgkqd" ) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
# 0upwovk3   7zfafnfq csko0bac ghggm1k7 i1d40oys kaa25up2
# 008lscsd tk9rc93b viqu542y x6n8do19 zmlc6h4w
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")
correct_data <-  dataset_gw1%>%filter(Pt.code != "8ij7agah" ) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
# 0upwovk3   7zfafnfq csko0bac ghggm1k7 i1d40oys kaa25up2
# 008lscsd tk9rc93b viqu542y x6n8do19 zmlc6h4w
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")
# Calculate mean intensity
correct_data <-  dataset_gw1%>%filter(Pt.code != "e2wtlj1f" ) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
# 0upwovk3   7zfafnfq csko0bac ghggm1k7 i1d40oys kaa25up2
# 008lscsd tk9rc93b viqu542y x6n8do19 zmlc6h4w
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")
correct_data <-  dataset_gw1%>%filter(Pt.code != "z3txa2mk" ) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
# 0upwovk3   7zfafnfq csko0bac ghggm1k7 i1d40oys kaa25up2
# 008lscsd tk9rc93b viqu542y x6n8do19 zmlc6h4w
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")
correct_data <-  dataset_gw1%>%filter(Pt.code != "0upwovk3" ) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
# 0upwovk3   7zfafnfq csko0bac ghggm1k7 i1d40oys kaa25up2
# 008lscsd tk9rc93b viqu542y x6n8do19 zmlc6h4w
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")
correct_data <-  dataset_gw1%>%filter(Pt.code != "zmlc6h4w" ) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
# 0upwovk3   7zfafnfq csko0bac ghggm1k7 i1d40oys kaa25up2
# 008lscsd tk9rc93b viqu542y x6n8do19 zmlc6h4w
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")
dataset_gw1$Pt.code
pts<-unique(dataset_gw1$Pt.code)
pts
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")%>%
set_caption(ftab, "my caption")
table_accuracy <- accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")%>%
set_caption( "my caption")
table_accuracy
pts<-unique(dataset_gw1$Pt.code)
for(i in 1:36){
# Calculate mean intensity
correct_data <-  dataset_gw1%>%filter(Pt.code != pts[i]) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
# 0upwovk3   7zfafnfq csko0bac ghggm1k7 i1d40oys kaa25up2
# 008lscsd tk9rc93b viqu542y x6n8do19
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
table_accuracy <- accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")%>%
set_caption( pts[i])
table_accuracy
}
for(i in 1:36){
# Calculate mean intensity
correct_data <-  dataset_gw1%>%filter(Pt.code != pts[i]) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
# 0upwovk3   7zfafnfq csko0bac ghggm1k7 i1d40oys kaa25up2
# 008lscsd tk9rc93b viqu542y x6n8do19
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")%>%
set_caption( pts[i])
}
i
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc)
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")%>%
set_caption( pts[i])
for(i in 1:36){
# Calculate mean intensity
correct_data <-  dataset_gw1%>%filter(Pt.code != pts[i]) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
pts[i]
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc)
}
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc)
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
for(i in 1:36){
# Calculate mean intensity
correct_data <-  dataset_gw1%>%filter(Pt.code != pts[i]) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
pts[i]
tab<- accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc)
tab
}
for(i in 1:36){
# Calculate mean intensity
correct_data <-  dataset_gw1%>%filter(Pt.code != pts[i]) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n) %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc)
}
correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n) %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc)
# Calculate mean intensity
correct_data <-  dataset_gw1%>%filter(Pt.code != pts[i]) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n) %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc)
# Calculate mean intensity
correct_data <-  dataset_gw1%>%filter(Pt.code != pts[i]) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n) %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc)
ta<-function(i){
# Calculate mean intensity
correct_data <-  dataset_gw1%>%filter(Pt.code != pts[i]) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")%>%
set_caption( pts[i])
}
ta(1)
ta(2)
ta(3)
ta(4)
ta(5)
ta(6)
ta(7)
ta(8)
ta(9)
ta(10)
ta(11)
ta(12)
ta(13)
ta(14)
ta(15)
ta(16)
ta(17)
ta(18)
ta(19)
ta(20)
ta(21)
ta(22)
ta(23)
ta(24)
ta(25)
ta(26)
ta(27)
ta(28)
ta(29)
ta(30)
ta(31)
ta(32)
ta(33)
ta(34)
ta(35)
ta(36)
ta(1)
ta(2)
ta(3)
ta(4)
ta(5)
ta(6)
ta(7)
ta(8)
ta(9)
ta(10)
ta(11)
ta(12)
ta(13)
ta(14)
ta(15)
ta(16)
ta(17)
ta(18)
ta(20)
ta(23)
ta(24)
ta(26)
ta(29)
ta(31)
ta(34)
ta(36)
pts<-unique(dataset_gw1$Pt.code)
ta<-function(i){
# Calculate mean intensity
correct_data <-  dataset_gw1%>%filter(Pt.code != pts[i]) %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "correct"))
accuracy<-correct_data%>%
group_by(subject, group, emotion, video_set) %>%
summarise(correct = sum(correct),
n = n(),
acc = correct/n)
accuracy %>%
group_by(group,emotion, video_set) %>%
summarise(acc = mean(acc, na.rm = TRUE)) %>%
pivot_wider(names_from = emotion, values_from = acc) %>%
flextable() %>%
colformat_double(digits = 2) %>%
autofit() %>%
merge_v(j = 1:2) %>%
theme_vanilla() %>%
align(align = "center")%>%
set_caption( pts[i])
}
ta(1)
ta(2)
ta(3)
ta(4)
ta(5)
ta(6)
ta(7)
ta(8)
ta(9)
ta(10)
ta(11)
ta(12)
ta(13)
ta(14)
ta(15)
ta(16)
ta(17)
ta(18)
ta(19)
ta(20)
ta(21)
ta(22)
ta(23)
ta(24)
ta(25)
ta(26)
ta(27)
ta(28)
ta(29)
ta(30)
ta(31)
ta(32)
ta(33)
ta(34)
ta(35)
ta(36)
# Plot accuracy GWE 1 vs GWE 2 ----------------------------------------------
dat_summ <- dataset_full %>%
filter( Video.emotion != "neutrality" , Wheel.task == "task") %>% # no match
drop_na(Video.emotion)%>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group,Wheel.name, Resp.category, Resp.correct) %>%
mutate(Resp.correct = 1)%>%
group_by(Pt.code,Video.emotion,Video.set,Pt.group,Wheel.name) %>%
mutate(n = n())%>%
group_by(Pt.code,Video.emotion,Video.set,Resp.category,Pt.group,Wheel.name) %>%
mutate( Resp.correct = sum(Resp.correct),
Resp.distribution = Resp.correct/n)%>%
summarize(Resp.distribution = mean(Resp.distribution))%>%
group_by(Video.emotion,Video.set,Resp.category,Pt.group,Wheel.name) %>%
summarize(Resp.distribution = mean(Resp.distribution)*8)
###########################################################################
rm(list=ls()) # remove all objects
# Functions & libraries---------------------------------------------------------------
devtools::load_all()
# Data --------------------------------------------------------------------
load(file.path("objects","palsy_circular.RData"))
# Calculate mean intensity
intensity_mean <-  dataset_gw1 %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.intensity, Resp.correct) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "intensity","correct"))
# Calculate intensity mean for neutral dataset
dat_neutral <- dataset_neutral %>%
dplyr::select(Pt.code,  Video.set, Video.emotion, Pt.group, Resp.intensity) %>%
'colnames<-'(c("subject" ,"video_set", "emotion", "group", "intensity"))
fit <- lmer(intensity ~ group * video_set + (1|subject),
data = intensity_mean%>%filter(correct == 1, emotion == "surprise" ))
car::Anova(fit, test.statistic= "Chisq", type = "3")
View(intensity_mean)
fit <- lmer(intensity ~ group * video_set + (1|subject),
data = intensity_mean%>%filter(correct == 1, emotion == "sadness" ))
car::Anova(fit, test.statistic= "Chisq", type = "3")
fit <- lmer(intensity ~ group * video_set + (1|subject),
data = intensity_mean%>%filter(correct == 1 ))
fit
# Fit linear mixed-effects model
fit <- lmer(intensity ~ group * video_set + (1|subject),
data = intensity_mean%>%filter(correct == 1 , emotion == "disgust"))
car::Anova(fit, test.statistic= "Chisq", type = "3")
# Fit linear mixed-effects model
fit <- lmer(intensity ~ group * video_set + (1|subject),
data = intensity_mean%>%filter(correct == 1 , emotion == "fear"))
car::Anova(fit, test.statistic= "Chisq", type = "3")
fit <- lmer(intensity ~ group * video_set + (1|subject),
data = intensity_mean%>%filter(correct == 1 , emotion == "anger"))
car::Anova(fit, test.statistic= "Chisq", type = "3")
table(intensity_mean$subject)
